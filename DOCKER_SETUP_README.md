# üê≥ Docker Setup –¥–ª—è PHP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

> –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Docker –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è PHP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Nginx –∏ PHP-FPM

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ](#-—á—Ç–æ-–≤–∫–ª—é—á–µ–Ω–æ)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [Troubleshooting](#-troubleshooting)

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d --build

# 2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:8000/

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs -f
```

**–ì–æ—Ç–æ–≤–æ!** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ http://localhost:8000/ üéâ

---

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- ‚úÖ **PHP 7.4-FPM** —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏: curl, json, dom, mbstring
- ‚úÖ **Nginx** –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- ‚úÖ **Docker Compose** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- ‚úÖ **Volumes** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è: `/` ‚Üí frontend, `/backend/api/*` ‚Üí PHP
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è API
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Nginx –∏ PHP
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PHP-FPM

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
- ‚úÖ –°—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## üíª –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [Docker](https://docs.docker.com/get-docker/) 20.10+
- [Docker Compose](https://docs.docker.com/compose/install/) 1.29+

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
docker --version
docker-compose --version
```

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)

```bash
git clone <your-repo>
cd <your-project>
```

### 2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

```
.
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ warehouses.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ kits.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ documents.php
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SbisService.php
‚îÇ   ‚îî‚îÄ‚îÄ config.php
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ app.js
‚îÇ   ‚îî‚îÄ‚îÄ style.css
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ nginx.conf
‚îî‚îÄ‚îÄ default.conf
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `backend/config.php` —Å –≤–∞—à–∏–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker-compose up -d --build
```

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º

```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose stop

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
docker-compose down

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker-compose up -d --build --force-recreate
```

### –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

| URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| http://localhost:8000/ | Frontend (–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞) |
| http://localhost:8000/backend/api/warehouses.php | API: –°–∫–ª–∞–¥—ã |
| http://localhost:8000/backend/api/kits.php | API: –ö–æ–º–ø–ª–µ–∫—Ç—ã |
| http://localhost:8000/backend/api/products.php | API: –ü—Ä–æ–¥—É–∫—Ç—ã |
| http://localhost:8000/backend/api/documents.php | API: –î–æ–∫—É–º–µ–Ω—Ç—ã |

### –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker exec -it php-app bash
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í—Å–µ –ª–æ–≥–∏
docker-compose logs -f

# –õ–æ–≥–∏ Nginx
docker exec php-app tail -f /var/log/nginx/access.log
docker exec php-app tail -f /var/log/nginx/error.log
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **[START_HERE.md](START_HERE.md)** | üöÄ –ù–∞—á–Ω–∏—Ç–µ –∑–¥–µ—Å—å - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç |
| **[QUICK_START.md](QUICK_START.md)** | ‚ö° –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ |
| **[DOCKER_README.md](DOCKER_README.md)** | üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| **[API_EXAMPLES.md](API_EXAMPLES.md)** | üîå –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API |
| **[ARCHITECTURE.md](ARCHITECTURE.md)** | üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã |
| **[CHECKLIST.md](CHECKLIST.md)** | ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| **[DOCKER_FILES_SUMMARY.md](DOCKER_FILES_SUMMARY.md)** | üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Linux/Mac:**
```bash
chmod +x test-docker.sh
./test-docker.sh
```

**Windows:**
```cmd
test-docker.bat
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É Docker –∏ Docker Compose
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –°–±–æ—Ä–∫—É –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å frontend –∏ API
- ‚úÖ –†–∞–±–æ—Ç—É PHP –∏ Nginx
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose ps

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ PHP
docker exec php-app php -v
docker exec php-app php -m

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx
docker exec php-app nginx -t

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ frontend
curl http://localhost:8000/

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost:8000/backend/api/warehouses.php
```

---

## üêõ Troubleshooting

### –ü–æ—Ä—Ç 8000 —É–∂–µ –∑–∞–Ω—è—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** `Error: bind: address already in use`

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ `docker-compose.yml`:
```yaml
ports:
  - "8080:8000"  # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 8080 –≤–º–µ—Å—Ç–æ 8000
```

### 502 Bad Gateway

**–ü—Ä–æ–±–ª–µ–º–∞:** Nginx –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PHP-FPM

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose restart

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PHP-FPM –∑–∞–ø—É—â–µ–Ω
docker exec php-app ps aux | grep php-fpm
```

### –û—à–∏–±–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** Permission denied –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ñ–∞–π–ª–∞–º

**–†–µ—à–µ–Ω–∏–µ:**
```bash
docker exec php-app chown -R www-data:www-data /var/www/html
docker exec php-app chmod -R 755 /var/www/html
```

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** CSS/JS —Ñ–∞–π–ª—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 404

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –≤ `frontend/index.html`:
```html
<!-- –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏) -->
<link rel="stylesheet" href="style.css">
<script src="app.js"></script>

<!-- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ -->
<link rel="stylesheet" href="/style.css">
<script src="/app.js"></script>
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker exec php-app nginx -t

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker-compose down
docker-compose up -d --build --force-recreate
```

### –ü–æ–¥—Ä–æ–±–Ω–µ–µ

–°–º. —Ä–∞–∑–¥–µ–ª Troubleshooting –≤ [DOCKER_README.md](DOCKER_README.md)

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `docker-compose.yml`:
```yaml
ports:
  - "–ù–û–í–´–ô_–ü–û–†–¢:8000"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PHP

1. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ `php.ini.example` –≤ `php.ini`
2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `Dockerfile`:
```dockerfile
COPY php.ini /usr/local/etc/php/conf.d/custom.ini
```
4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ: `docker-compose up -d --build`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `default.conf` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
docker-compose restart
```

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Browser (http://localhost:8000)
    ‚Üì
Docker Container (php-app)
    ‚Üì
Nginx :8000
    ‚îú‚îÄ‚îÄ / ‚Üí frontend/index.html
    ‚îú‚îÄ‚îÄ /style.css, /app.js ‚Üí frontend/
    ‚îî‚îÄ‚îÄ /backend/api/*.php ‚Üí PHP-FPM :9000
            ‚Üì
        PHP 7.4-FPM
            ‚Üì
        backend/api/*.php
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [ARCHITECTURE.md](ARCHITECTURE.md)

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. üìñ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [DOCKER_README.md](DOCKER_README.md)
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ [test-docker.sh](test-docker.sh) –∏–ª–∏ [test-docker.bat](test-docker.bat)
3. üêõ –°–º. —Ä–∞–∑–¥–µ–ª [Troubleshooting](#-troubleshooting)
4. üìù –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs`

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Docker –æ–±—Ä–∞–∑—ã:
- [PHP Official Image](https://hub.docker.com/_/php)
- [Nginx Official Image](https://hub.docker.com/_/nginx)

---

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ:**
```bash
docker-compose up -d --build
```

**–û—Ç–∫—Ä–æ–π—Ç–µ:**
```
http://localhost:8000/
```

**–£–¥–∞—á–∏! üöÄ**

---

## üìå –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](START_HERE.md)
- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](DOCKER_README.md)
- [–ü—Ä–∏–º–µ—Ä—ã API](API_EXAMPLES.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](ARCHITECTURE.md)
- [–ß–µ–∫–ª–∏—Å—Ç](CHECKLIST.md)
